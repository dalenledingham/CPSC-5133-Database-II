DROP TABLE Rooms;
DROP TABLE Patients;
DROP TABLE Treatments;
DROP TABLE OrderedTreatments;
DROP TABLE AdministeredTreatments;
DROP TABLE Diagnoses;
DROP TABLE PatientDiagnoses;
DROP TABLE Employees;
DROP TABLE EmergencyContacts;

CREATE TABLE Rooms
(
    rid INTEGER,
    roomNum INTEGER,
    pid INTEGER,
    admitDate SMALLDATETIME,
    eid INTEGER,
    PRIMARY KEY (rid AUTOINCREMENT),
    FOREIGN KEY (pid) REFERENCES Patients (pid),
    FOREIGN KEY (eid) REFERENCES Employees (eid)
);
CREATE TABLE Patients
(
    pid INTEGER,
    firstName VARCHAR,
    lastName VARCHAR UNIQUE,
    eid INTEGER,
    ecid INTEGER,
    insPolicy VARCHAR,
    insCompany VARCHAR,
    admitDate SMALLDATETIME,
    dischargeDate SMALLDATETIME,
    PRIMARY KEY (pid AUTOINCREMENT),
    FOREIGN KEY (eid) REFERENCES Employees (eid),
    FOREIGN KEY (ecid) REFERENCES EmergencyContacts (ecid)
);
CREATE TABLE Treatments
(
    tid INTEGER,
    treatmentType VARCHAR,
    treatmentName VARCHAR,
    PRIMARY KEY (tid AUTOINCREMENT)
);
CREATE TABLE OrderedTreatments
(
    tid INTEGER,
    pid INTEGER,
    eid INTEGER,
    orderTime SMALLDATETIME,
    PRIMARY KEY (tid, pid, eid),
    FOREIGN KEY (tid) REFERENCES Treatments (tid),
    FOREIGN KEY (pid) REFERENCES Patients (pid),
    FOREIGN KEY (eid) REFERENCES Employees (eid)
);
CREATE TABLE AdministeredTreatments
(
    tid INTEGER,
    pid INTEGER,
    eid INTEGER,
    adminTime SMALLDATETIME,
    PRIMARY KEY (tid, pid, eid),
    FOREIGN KEY (tid) REFERENCES Treatments (tid),
    FOREIGN KEY (pid) REFERENCES Patients (pid),
    FOREIGN KEY (eid) REFERENCES Employees (eid)
);
CREATE TABLE Diagnoses
(
    diagnosisID INTEGER,
    diagnosisName VARCHAR,
    PRIMARY KEY (diagnosisID AUTOINCREMENT)
);
CREATE TABLE PatientDiagnoses
(
    diagnosisID INTEGER,
    pid INTEGER,
    admitDate SMALLDATETIME,
    dischargeDate SMALLDATETIME,
    PRIMARY KEY (diagnosisID, pid, admitDate),
    FOREIGN KEY (diagnosisID) REFERENCES Diagnoses (diagnosisID),
    FOREIGN KEY (pid) REFERENCES Patients (pid),
    FOREIGN KEY (admitDate) REFERENCES Patients (admitDate),
    FOREIGN KEY (dischargeDate) REFERENCES Patients (dischargeDate)
);
CREATE TABLE Employees
(
    eid INTEGER,
    firstName VARCHAR,
    lastName VARCHAR UNIQUE,
    jobCategory VARCHAR,
    PRIMARY KEY (eid AUTOINCREMENT)
);
CREATE TABLE EmergencyContacts
(
    ecid INTEGER,
    name VARCHAR,
    phone VARCHAR(12),
    PRIMARY KEY (ecid AUTOINCREMENT)
);
CREATE TABLE AdditionalDoctors
(
    eid INTEGER,
    pid INTEGER,
    PRIMARY KEY (eid, pid),
    FOREIGN KEY (eid) REFERENCES Employees (eid),
    FOREIGN KEY (pid) REFERENCES Patients (pid)
);
